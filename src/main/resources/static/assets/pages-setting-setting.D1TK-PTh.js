import{M as e,o as t,c as o,w as l,g as a,y as i,a as s,t as n,z as p,h as u,N as c,f as r,I as d,p as f,s as h,aa as m,Z as g,e as y,r as b,j as k}from"./index-BPWBSeUu.js";import{_ as x}from"./_plugin-vue_export-helper.BCo6x5W8.js";import{r as _}from"./uni-app.es.B1Bjb5HC.js";import{_ as T}from"./uni-popup.DXps9OGM.js";import{n as v}from"./header.CpST7y72.js";import{c as C}from"./userinfo.1w3Y5rmZ.js";const $={data:()=>({}),created(){this.popup=this.getParent()},methods:{getParent(e="uniPopup"){let t=this.$parent,o=t.$options.name;for(;o!==e;){if(t=t.$parent,!t)return!1;o=t.$options.name}return t}}},S={en:{"uni-popup.cancel":"cancel","uni-popup.ok":"ok","uni-popup.placeholder":"pleace enter","uni-popup.title":"Hint","uni-popup.shareTitle":"Share to"},"zh-Hans":{"uni-popup.cancel":"取消","uni-popup.ok":"确定","uni-popup.placeholder":"请输入","uni-popup.title":"提示","uni-popup.shareTitle":"分享到"},"zh-Hant":{"uni-popup.cancel":"取消","uni-popup.ok":"確定","uni-popup.placeholder":"請輸入","uni-popup.title":"提示","uni-popup.shareTitle":"分享到"}},{t:j}=e(S);const V=x({name:"uniPopupDialog",mixins:[$],emits:["confirm","close","update:modelValue","input"],props:{inputType:{type:String,default:"text"},showClose:{type:Boolean,default:!0},modelValue:{type:[Number,String],default:""},placeholder:{type:[String,Number],default:""},type:{type:String,default:"error"},mode:{type:String,default:"base"},title:{type:String,default:""},content:{type:String,default:""},beforeClose:{type:Boolean,default:!1},cancelText:{type:String,default:""},confirmText:{type:String,default:""},maxlength:{type:Number,default:-1},focus:{type:Boolean,default:!0}},data:()=>({dialogType:"error",val:""}),computed:{okText(){return this.confirmText||j("uni-popup.ok")},closeText(){return this.cancelText||j("uni-popup.cancel")},placeholderText(){return this.placeholder||j("uni-popup.placeholder")},titleText(){return this.title||j("uni-popup.title")}},watch:{type(e){this.dialogType=e},mode(e){"input"===e&&(this.dialogType="info")},value(e){-1!=this.maxlength&&"input"===this.mode?this.val=e.slice(0,this.maxlength):this.val=e},val(e){this.$emit("update:modelValue",e)}},created(){this.popup.disableMask(),"input"===this.mode?(this.dialogType="info",this.val=this.value,this.val=this.modelValue):this.dialogType=this.type},methods:{onOk(){"input"===this.mode?this.$emit("confirm",this.val):this.$emit("confirm"),this.beforeClose||this.popup.close()},closeDialog(){this.$emit("close"),this.beforeClose||this.popup.close()},close(){this.popup.close()}}},[["render",function(e,f,h,m,g,y){const b=c,k=r,x=d;return t(),o(k,{class:"uni-popup-dialog"},{default:l((()=>[a(k,{class:"uni-dialog-title"},{default:l((()=>[a(b,{class:i(["uni-dialog-title-text",["uni-popup__"+g.dialogType]])},{default:l((()=>[s(n(y.titleText),1)])),_:1},8,["class"])])),_:1}),"base"===h.mode?(t(),o(k,{key:0,class:"uni-dialog-content"},{default:l((()=>[p(e.$slots,"default",{},(()=>[a(b,{class:"uni-dialog-content-text"},{default:l((()=>[s(n(h.content),1)])),_:1})]),!0)])),_:3})):(t(),o(k,{key:1,class:"uni-dialog-content"},{default:l((()=>[p(e.$slots,"default",{},(()=>[a(x,{class:"uni-dialog-input",maxlength:h.maxlength,modelValue:g.val,"onUpdate:modelValue":f[0]||(f[0]=e=>g.val=e),type:h.inputType,placeholder:y.placeholderText,focus:h.focus},null,8,["maxlength","modelValue","type","placeholder","focus"])]),!0)])),_:3})),a(k,{class:"uni-dialog-button-group"},{default:l((()=>[h.showClose?(t(),o(k,{key:0,class:"uni-dialog-button",onClick:y.closeDialog},{default:l((()=>[a(b,{class:"uni-dialog-button-text"},{default:l((()=>[s(n(y.closeText),1)])),_:1})])),_:1},8,["onClick"])):u("",!0),a(k,{class:i(["uni-dialog-button",h.showClose?"uni-border-left":""]),onClick:y.onOk},{default:l((()=>[a(b,{class:"uni-dialog-button-text uni-button-color"},{default:l((()=>[s(n(y.okText),1)])),_:1})])),_:1},8,["class","onClick"])])),_:1})])),_:3})}],["__scopeId","data-v-19f0223c"]]);const w=x({name:"setting",components:{navbar:v},methods:{change(){this.$refs.popup.open()},close(){this.$refs.popup.close()},confirm(e){""!=e?C(e).then((e=>{f({title:"修改成功",icon:"success",duration:2e3}),this.$refs.popup.close()})).catch((e=>{f({title:e,icon:"error",duration:2e3}),this.$refs.popup.close()})):f({title:"请输入密码",icon:"error",duration:2e3})},clearbook(){h({title:"清除缓存",content:"是否清除书本缓存？",confirmText:"清除",cancelText:"返回",success:async e=>{if(e.confirm){console.log("清除书本缓存");for(var t=m().keys,o=0;o<t.length;o++)(t[o].includes("book_content")||t[o].includes("book_cata")||t[o].includes("book_cache"))&&g(t[o])}}})},clearset(){h({title:"清除缓存",content:"是否恢复默认设置？",confirmText:"确认",cancelText:"返回",success:async e=>{if(e.confirm){for(var t=m().keys,o=0;o<t.length;o++)t[o].includes("api")||t[o].includes("api_token")||t[o].includes("book_content")||t[o].includes("book_cata")||t[o].includes("book_cache")||t[o].includes("history")||g(t[o])}}})}}},[["render",function(e,i,s,n,p,u){const c=r,d=y("navbar"),f=_(b("uni-popup-dialog"),V),h=_(b("uni-popup"),T);return t(),o(c,{class:"page-container"},{default:l((()=>[a(c,{class:"status_bar"}),a(d,{title:"设置",background:"#ffffff",ref:"headerref"},null,512),k("br"),k("div",{class:"settings-list"},[k("div",{class:"settings-item",onClick:i[0]||(i[0]=(...t)=>e.clearbook&&e.clearbook(...t))},[k("span",null,"清除书本缓存")]),k("div",{class:"settings-item",onClick:i[1]||(i[1]=(...t)=>e.clearset&&e.clearset(...t))},[k("span",null,"恢复默认设置")])]),a(h,{ref:"popup",type:"dialog"},{default:l((()=>[a(f,{title:"修改密码",placeholder:"请输入新密码",mode:"input",message:"成功消息",duration:2e3,"before-close":!0,onClose:e.close,onConfirm:e.confirm},null,8,["onClose","onConfirm"])])),_:1},512)])),_:1})}],["__scopeId","data-v-bfa6716d"]]);export{w as default};
