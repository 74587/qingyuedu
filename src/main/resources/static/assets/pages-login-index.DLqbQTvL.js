import{E as s,G as a,H as e,s as t,J as i,p as o,c as l,w as n,f as d,o as r,g as u,j as c,y as p,a as h,h as m,I as f,K as g,i as w,L as _}from"./index-BPWBSeUu.js";import{_ as b}from"./_plugin-vue_export-helper.BCo6x5W8.js";const k=b({name:"index",data:()=>({username:"",password:"",logindisabled:!1,api:"",ish5:!1}),mounted(){this.ish5=!0},onBackPress(s){if("backbutton"==s.from)return!0},methods:{buttonclick(){""!=this.api||this.ish5?""!=this.username&&""!=this.password?(this.ish5||i("api",this.api),this.showLoading("加载中"),this.logindisabled=!0,((t,i)=>{const{model:o}=s();return new Promise(((s,l)=>{a({method:"POST",url:e()+"/login",data:{username:t,password:i,model:o},header:{"content-type":"application/x-www-form-urlencoded"},success:a=>{1==a.data.isSuccess?s(a.data.data.accessToken):l(a.data.errorMsg)},fail:()=>{l("网络错误")}})}))})(this.username,this.password).then((s=>{this.hideLoading(),this.getBookSources(),this.isLogin=!0,this.$store.commit("updatelohintocken",s),o({title:"登陆成功",duration:2e3}),this.back()})).catch((s=>{this.logindisabled=!1,this.hideLoading(),t({title:"提示",showCancel:!1,content:s})}))):t({title:"提示",showCancel:!1,content:"请填写用户名或密码"}):t({title:"提示",showCancel:!1,content:"请填写后端地址"})}}},[["render",function(s,a,e,t,i,o){const b=f,k=g,V=d,x=w,y=_;return r(),l(V,{class:"container"},{default:n((()=>[u(V,{class:"login-form"},{default:n((()=>[c("h1",{class:"title"},"欢迎回来"),u(y,{id:"loginForm"},{default:n((()=>[s.ish5?m("",!0):(r(),l(V,{key:0,class:"input-group"},{default:n((()=>[c("i",{class:"material-icons"},"computer"),u(b,{modelValue:s.api,"onUpdate:modelValue":a[0]||(a[0]=a=>s.api=a),type:"text",required:""},null,8,["modelValue"]),u(k,{class:p(""==s.api?"":"hasinput"),for:"api"},{default:n((()=>[h("后端")])),_:1},8,["class"])])),_:1})),u(V,{class:"input-group"},{default:n((()=>[c("i",{class:"material-icons"},"person"),u(b,{modelValue:s.username,"onUpdate:modelValue":a[1]||(a[1]=a=>s.username=a),type:"text",required:""},null,8,["modelValue"]),u(k,{class:p(""==s.username?"":"hasinput"),for:"username"},{default:n((()=>[h("用户名")])),_:1},8,["class"])])),_:1}),u(V,{class:"input-group"},{default:n((()=>[c("i",{class:"material-icons"},"lock"),u(b,{modelValue:s.password,"onUpdate:modelValue":a[2]||(a[2]=a=>s.password=a),type:"password",required:""},null,8,["modelValue"]),u(k,{class:p(""==s.password?"":"hasinput"),for:"password"},{default:n((()=>[h("密码")])),_:1},8,["class"])])),_:1}),u(x,{class:p(["login-button",s.logindisabled?"disabled-button":""]),onClick:s.buttonclick,type:"submit"},{default:n((()=>[h("登 录")])),_:1},8,["class","onClick"])])),_:1})])),_:1})])),_:1})}],["__scopeId","data-v-79aaf1f7"]]);export{k as default};
